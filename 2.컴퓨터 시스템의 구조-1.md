# 컴퓨터 시스템의 동작 원리

## 3-1. 컴퓨터 시스템의 구조

컴퓨터 시스템의 구조는 컴퓨터 내부장치인 CPU,메모리와 컴퓨터 외부 장치인 디스크,키보드,마우스,모니터,네트워크 장치 등으로 구성된다.
컴퓨터는 외부장치에서 내부장치로 데이터를 읽어와 각종 연산을 수행한 후 그 결과를 외부장치로 내보낸다.
컴퓨터 내부로 데이터가 들어오는 것을 입력(input) 이라 하고, 컴퓨터 외부장치로 데이터가 나가는것을 출력(output) 이라 한다.

## 커널(kernel)

운영체제의 모든 부분을 다 메모리에 상주시키면 메모리 낭비가 심하므로
꼭 필요한 핵심 부분만 항상 메모리에 올라가있따. 이 부분을 커널이라고 한다.

## 인터럽트의 일반적 기능

## Mode bit

사용자 프로그램의 잘못된 수행으로 다른 프로그램 및 운영체제에 피해가 가지 않도록 하기 위한 보호 장치

- Mode bit을 통해 하드웨어적으로 두 가지 모드의 operation 지원

```
  1 사용자 모드 : 사용자 프로그램 수행
  0 모니터 모드 : OS 코드 수행
```

- 보안을 해칠 수 있는 중요한 명령어는 모니터 모드에서만 수행 가능한 "특권명령"으로 규정
- Interrupt나 Exception 발생시 하드웨어가 mode bit을 0으로 바꿈
- 사용자 프로그램에게 CPU를 넘기기 전에 mode bit을 1로 셋팅

## Timer

타이머

- 정해진 시간이 흐른 뒤 운영체제에게 제어권이 넘어가도록 인터럽트를 발생시킴
- 타이머는 매 클릭 틱 때마다 1씩 감소
- 타이머 값이 0이 되면 타이머 인터럽트 발생
- CPU를 특정 프로그램이 독점하는 것으로부터 보호

## Device Controller

- I/O(입출력 장치)를 전담하는 일종의 작은 CPU라고 생각하면 된다.
- 제어 정보를 위해 control register, status register를 가짐
- local buffer를 가짐 (일종의 data register)
- I/O는 실제 device와 local buffer 사이에서 일어남
- Device controller 는 I/O가 끝났을 경우 interrupt로 CPU에 그 사실을 알림

## CPU 연산과 I/O 연산

입출력 장치들의 I/O 연산은 입출력 컨트롤러가 담당하고, 컴퓨터 내에서 수행되는 연산은
CPU가 담당한다.

각 장치마다 이를 제어하기 위해 설치된 장치 컨트롤러는 장치로부터 들어오고 나가는 데이터를 임시로 저장하기 위한
로컬버퍼(local buffer)라는 작은 메모리를 가지고 있다.

키보드에서 데이터를 읽어오는 경우, 우선 로컬버퍼에 데이터가 임시로 저장된 후 메모리에 전달된다.
이때 장치에서 로컬버퍼로 읽어오는 일은 컨트롤러가 담당한다.
로컬버퍼에 데이터를 읽어오는 일이 끝나면 컨트롤러가 인터럽트를 발생시켜 CPU에게 알린다.

CPU는 매 시점 메모리에서 명령을 하나씩 읽어서 수행하는데 이떄 CPU 옆에는 인터럽트라인이 있어서,
CPU가 자신의 작업을 하던 중간에 인터럽트 라인에 신호가 들어오면(외부 장치컨트롤러가 인터럽트를 발생시킴) 하던일을 멈추고
인터럽트와 관련된 일을 수행한다.
좀 더 정확히 말하면 CPU는 명령 하나를 수행할때마다 인터럽트가 발생한지 확인을하고, 인터럽트가 발생했으면 다음 명령을 수행하기전에
인터럽트 처리를 하게 된다.

## mode bit

## register

## 타이머의 역할

특정 프로그램이 CPU를 독점하지 못하게 하기 위함

## DMA(Direct Memory Access)

직접 메모리에 접근할수있는 컨트롤러

## 인터럽트

## Device Controller

각 디바이스마다 전담하기 위한 작은 CPU가 붙어있다.(하드웨어)

### device driver(소프트웨어)
